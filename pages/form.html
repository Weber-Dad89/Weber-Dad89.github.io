<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comment Form</title>

    <link href="https://fonts.googleapis.com/css2?family=Electrolize&family=Geo:ital@0;1&family=Iceberg&family=Michroma&family=Nabla&family=Orbitron:wght@400..900&family=Quantico:ital,wght@0,400;0,700;1,400;1,700&family=Silkscreen:wght@400;700&family=Zen+Dots&display=swap" rel="stylesheet">

    <style>
        /* CSS styling */
        body, h1, h3 {
            text-align: center;
            background-color: blueviolet;
        }

        h1, h3, .sageText {
            font-family: 'Iceberg';
            margin-bottom: 0.5em;
        }

        form {
            display: flex;
            flex-direction: column;
            align-items: center;
            /* Form outline */
            padding: 1em;
            border: 1px solid #cccccc;
            border-radius: 1em;
        }

        .inputBoxes, #inputLabels {
            font: 1em 'Orbitron';
            margin-top: .5em;
        }

        label {
            /* Uniform size & alignment */
            display: inline-block;
            min-width: 45px;
            text-align: right;
        }

        input {
            /* To make sure that all the text fields have the same font settings */
            font: 1em 'Electrolize';
            /* Uniform text field size */
            width: 200px;
            box-sizing: border-box;
            /* Matches form field borders */
            border: 1px solid #999999;
        }

        textarea {
            display: block;
            font: 1em 'Orbitron';
            margin: 1em auto;
            box-sizing: border-box;
            border: 5px double blueviolet;
        }

        .button {
            /* Align button with the text fields */
            margin: 1em auto; /* matches the same size as the label elements */
        }

        button {
            margin: 1em auto 0 auto;
            width: auto;
            align-self: center;
        }


    </style>
</head>
<body>
    <h1 id="title" style="position: center;">Cipher Sage Comment Form</h1>

    <p class="sageText">Have something to say, enter information and leave a <strong>Comment</strong>
    below!</p>

    <form id="commentForm" action="process.php" method="get">
        <p id="inputLabels" class="inputBoxes">

        <label for="name">Name:</label>
        <input
            id="name"
            type="text"
            name="userName"
            pattern="[A-Za-z ]{2,30}"
            title="Your name must be between 2 and 50 characters, containing only letters and spaces."
            >
        
        <!--Need to fix styling of the format-->
        <label for="phone">Phone:<br />
        <!--small>Format: 123-456-7890</small-->
        </label>
        <input
            id="phone"
            type="tel"
            name="phoneNum"
            pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}"
            title="Please match the format: 123-456-7890"
            >

        <label for="email">Email:</label>
        <input id="email" type="email" name="email" autocomplete="email" title="example email: john.doe@email.com">
        </p>

        <h3>Leave a comment:</h3>
        <textarea id="msg" type="text" name="userMsg" rows="5" cols="40" placeholder="Type here..."></textarea>

        <span id="feedbackMsg" >Fill the data and click the button when finished.</span><br>
            <button type="submit">Send Your Message</button>

        <span id="invalidEntryMessage" ></span>
    </form>

    <script>

        // This is used to perform checks on user input and make sure they dont do any of the below options
        document.getElementById('commentForm').addEventListener('submit', function(event){
            let name= document.getElementById('name').value;
            let phone= document.getElementById('phone').value;
            let email=document.getElementById('email').value;
            let message= document.getElementById('msg').value;
            let invalidEntryMessage= document.getElementById('invalidEntryMessage');

             // Prevents the submission of the form until data meets reuirements
            if (name === "" || phone === "" || email === "") {
                invalidEntryMessage.innerText= 'Fields cannot be blank. All fields must be filled out to submit.';
                event.preventDefault();
            }

            else if (phone != true) {
                invalidEntryMessage.innerText= "Invalid entry: Please enter your phone in the correct format.";
                event.preventDefault();
            }

            else if (email != true) {
                invalidEntryMessage.innerText= "Please enter a correct email address."
                event.preventDefault();
            }
            
            else if (name.includes(email)) {
                invalidEntryMessage.innerText= "Invalid entry: Your email cannot be your user name.";
                event.preventDefault();
            }

            else if (message === "") {
                invalidEntryMessage.innerText= "Don't forget to enter your comment then submit."
                event.preventDefault();
            }

            else {
                invalidEntryMessage.innerText= ""; // clears error message if valid and submits form
            }


        });
            
        //  30 char maximum, input of correct name using lower-case and, upper-case letter
        //  checks that phone is entered correctly and no special characters in name
        // the EventListener will inform the user in real-time what is required when adding data to forms!!!

        // name validation func
        document.getElementById('name').addEventListener('input', function() {
            console.log('user is typing in name input');
            let name= this.value;
            let feedbackMsg=document.getElementById('feedbackMsg');
            const missing= [];

            if (name.length > 50)
                missing.push('50- character maximum');

            let hasLower= /[a-z]/.test(name);
            if (!hasLower)
                missing.push('lower-case letter');

            let hasUpper= /[A-Z]/.test(name);
            if (!hasUpper)
                missing.push('Upper-case letter');

            // TODO: Fix this conditional statement
            let hasNumber= /[0-9]/.test(name);
            if (hasNumber) {
                missing.push('cannot contain numbers');
            }

            let hasSpecial= /[$%&*!@#]/.test(name);
            if (hasSpecial)
                missing.push('no special characters in name');

            feedbackMsg.innerText= "Name requirements: " + missing;
            });

        //  phone validation func
        document.getElementById('phone').addEventListener('input', function() {
            console.log('user is typing in phone input');
            let phone= this.value;
            let feedbackMsg=document.getElementById('feedbackMsg');
            const pattern= /^[1-9]\d{2}-\d{3}-\d{4}$/;        //  regex expression matching format: 123-456-7890
            const missing= [];

            let hasTel= /[0-9]/.test(phone);
            if (!hasTel)
                missing.push('Incorrect phone number');

            if (!pattern.test(phone)) {
                feedbackMsg.innerText= "Phone number must be in this format: 123-456-7890";
            }
            else {
                feedbackMsg.innerText= "";
            }
            });

            //  phone validation func
        document.getElementById('email').addEventListener('input', function() {
            console.log('user is typing in email input');
            let email= this.value;
            let feedbackMsg=document.getElementById('feedbackMsg');
            const pattern= /^[^@\s]+@[^@\s]+\.[^@\s]+$/;        //  regex expression matching format: abc@email.xxx
            
            if (!pattern.test(email)) {
                invalidEntryMessage.innerText= "Please enter a valid email address that includes @ and . (domain)";
            } else {
                feedbackMsg.innerText= "";
            }
        });

    </script>

    
</body>
</html>